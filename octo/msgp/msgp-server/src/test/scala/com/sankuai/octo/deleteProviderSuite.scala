package com.sankuai.octo

import com.sankuai.msgp.common.model.Env
import com.sankuai.msgp.common.model.ServiceModels.AppkeyTs
import com.sankuai.msgp.common.model.Path
import com.sankuai.octo.msgp.utils.client.ZkClient
import org.junit.runner.RunWith
import org.scalatest.junit.JUnitRunner
import org.scalatest.{BeforeAndAfter, FunSuite}
import play.api.libs.json.Json

/**
 * Created by lhmily on 12/21/2015.
 */
@RunWith(classOf[JUnitRunner])
class deleteProviderSuite extends FunSuite with BeforeAndAfter{
  test("delete") {
    val appkey="com.sankuai.inf.sg_agent"
    val ipList=List("10.4.221.221","10.4.254.232","10.124.6.189","127.0.0.3","10.124.2.112","10.5.239.161","10.4.254.235","10.4.238.230","10.5.239.182","10.4.240.41","10.4.254.233","10.20.255.248","10.32.93.80","10.124.2.50","10.32.78.193","10.4.101.159","10.32.104.224","10.32.78.192","10.66.11.141","10.4.101.212","10.2.28.36","10.124.3.248","10.124.1.130","10.2.28.84","10.2.28.146","10.2.18.211","10.124.5.24","10.2.28.41","10.2.18.222","10.124.2.231","10.124.2.219","10.124.1.209","10.124.6.116","10.2.28.48","10.124.5.139","10.124.1.239","10.4.231.86","10.4.233.21","10.2.28.17","10.2.28.64","10.124.3.58","10.124.6.143","10.124.3.80","10.4.242.46","10.124.2.85","10.124.5.17","10.4.238.154","10.124.5.27","10.2.28.117","10.4.235.35","10.124.1.159","10.124.5.143","10.2.28.28","10.124.1.52","10.124.2.251","10.124.5.224","10.124.3.199","10.124.1.146","172.26.14.68","10.124.1.117","10.0.233.1","10.69.161.60","10.5.233.144","10.5.236.219","10.2.28.128","10.4.233.131","10.4.246.210","10.4.240.84","10.66.11.72","10.4.229.229","10.2.28.144","10.124.6.81","10.124.2.129","10.124.5.158","10.124.3.250","10.124.3.187","10.124.3.161","10.2.18.213","10.2.9.38","10.124.1.208","10.4.233.150","10.69.160.221","10.2.29.56","10.124.5.144","10.124.1.49","10.4.239.168","10.124.2.94","10.124.3.96","10.124.6.239","10.124.2.68","10.124.5.199","10.124.6.217","10.2.28.79","10.2.18.154","10.4.236.115","10.124.4.232","10.124.3.81","10.124.5.249","10.124.5.171","10.124.5.125","10.4.239.26","10.5.235.38","10.124.1.26","10.124.5.239","10.4.246.38","10.124.3.162","10.2.21.214","10.124.5.8","10.2.28.134","10.4.229.165","10.124.3.220","10.4.240.252","10.2.9.137","10.124.5.14","10.5.234.221","10.2.21.218","10.124.4.87","10.124.5.142","10.4.228.144","10.2.21.213","10.4.241.27","10.2.29.58","10.4.242.178","10.66.59.99","10.4.230.133","10.124.2.73","10.5.237.121","10.2.18.135","10.4.229.106","10.124.2.35","10.124.1.38","10.124.2.44","10.124.3.118","10.124.5.66","10.124.6.178","10.66.11.112","10.124.1.125","10.2.28.156","10.4.235.175","10.124.3.167","10.2.28.32","10.2.28.33","10.124.3.47","10.2.10.64","10.124.5.10","10.124.1.139","10.124.5.214","10.4.235.167","10.124.5.187","10.2.28.95","10.2.28.115","10.124.5.2","10.5.234.200","10.66.6.100","10.2.28.208","10.66.13.214","10.124.4.74","10.124.4.69","10.124.4.27","10.124.2.18","10.4.233.140","10.66.11.94","10.124.5.198","10.4.234.13","10.124.5.184","10.124.5.200","10.124.1.185","10.124.5.232","10.124.3.179","10.124.1.244","10.124.6.198","10.2.13.44","10.124.5.64","10.2.28.87","10.124.2.39","10.4.241.107","10.5.238.160","10.124.4.111","10.4.231.10","10.4.230.8","10.124.3.147","10.124.3.116","10.69.164.224","10.4.236.51","10.124.2.142","10.124.5.100","10.2.28.82","10.124.6.7","10.124.2.69","10.4.232.250","10.4.236.94","10.2.28.122","10.2.30.47","10.124.2.186","10.2.28.175","10.5.235.45","10.124.2.237","10.124.4.117","10.124.5.92","10.124.4.14","10.124.1.11","10.124.6.34","10.124.5.116","10.5.232.67","10.4.230.3","10.124.2.103","10.124.1.69","10.124.4.116","10.2.21.211","10.124.2.156","10.124.2.108","10.124.5.180","10.124.5.169","10.124.1.4","10.124.1.154","10.124.4.144","10.124.5.76","10.2.28.23","10.4.228.212","10.124.6.61","10.124.6.65","10.124.5.38","10.124.5.102","10.124.4.209","10.124.4.114","10.124.1.70","10.4.231.234","10.2.28.71","10.124.3.126","10.124.1.74","10.124.6.226","10.124.6.231","10.124.4.158","10.2.28.96","10.2.28.123","10.124.5.88","10.124.1.20","10.124.3.72","10.124.2.123","10.124.5.59","10.2.28.89","10.124.2.21","10.2.29.53","10.2.29.181","10.66.66.74","10.2.28.98","10.2.28.66","10.4.246.90","10.124.4.120","10.2.28.111","10.4.233.147","10.124.3.64","10.124.2.101","10.124.1.129","10.124.5.51","10.124.2.30","10.124.5.132","10.124.4.216","10.5.245.77","10.4.229.146","10.4.229.120","10.124.4.156","10.5.236.246","10.124.2.63","10.4.236.174","10.4.229.8","10.2.28.37","10.4.233.76","10.2.29.54","10.124.3.119","10.4.239.76","10.124.6.133","10.124.5.145","10.2.28.91","10.2.21.219","10.124.5.91","10.4.233.192","10.124.2.90","10.124.6.242","10.2.28.107","10.2.28.44","10.2.28.13","10.2.28.133","10.4.236.197","10.124.2.107","10.2.28.125","10.2.28.121","10.124.2.126","10.66.11.114","10.124.2.32","10.2.28.176","10.124.1.42","10.2.21.208","10.2.28.43","10.124.3.201","10.124.5.251","10.2.28.74","10.124.2.232","10.124.5.201","10.124.4.228","10.124.1.109","10.124.5.221","10.2.28.131","10.2.18.231","10.2.28.113","10.124.3.146","10.124.3.48","10.124.4.251","10.66.21.64","10.124.3.31","10.4.231.150","10.124.3.76","10.124.5.6","10.4.233.19","10.124.2.157","10.124.3.243","10.2.28.12","10.124.1.147","10.5.239.109","10.124.3.186","10.2.18.203","10.124.4.52","10.124.2.167","10.124.2.191","10.124.3.9","10.2.29.51","10.2.28.86","10.4.231.4","10.124.2.25","10.124.5.154","10.2.28.68","10.124.3.216","10.4.245.136","10.2.28.129","10.124.1.30","10.4.229.221","10.124.4.20","10.4.237.39","10.8.0.1","10.4.236.86","10.124.1.135","10.124.3.10","10.124.6.78","10.124.1.19","10.2.28.31","10.66.15.95","10.4.241.104","10.4.232.149","10.4.229.90","10.2.28.139","10.124.2.173","10.2.18.148","10.5.232.245","10.69.165.231","10.2.18.159","10.124.3.61","10.124.2.155","10.124.3.2","10.124.1.203","10.124.4.67","10.4.228.53","10.124.1.67","10.124.5.120","10.124.2.178","10.124.3.254","10.124.2.109","10.2.28.147","10.124.4.84","10.124.6.125","10.4.230.27","10.2.28.35","10.124.3.223","10.124.3.13","10.124.6.68","10.2.28.27","10.124.1.72","10.124.1.25","10.4.229.54","10.2.27.149","10.124.1.108","10.66.68.58","10.4.240.178","10.5.241.61","10.124.6.243","10.2.28.158","10.2.28.26","10.124.1.43","10.2.18.216","10.124.3.42","10.124.6.139","10.2.28.108","10.124.4.26","10.124.3.206","10.124.6.77","10.124.2.181","10.124.1.40","10.4.229.177","10.124.1.101","10.124.6.98","10.124.3.252","10.2.18.215","10.2.28.76","10.4.233.6","10.124.5.117","10.124.5.119","10.124.4.100","10.2.28.102","10.124.2.229","10.2.28.97","10.4.244.222","10.124.2.118","10.124.3.18","10.124.3.188","10.124.6.14","10.2.28.132","10.2.28.143","10.124.3.148","10.4.230.217","10.124.5.7","10.124.6.114","10.124.5.234","10.124.5.197","10.2.30.68","10.4.236.184","10.69.160.176","10.4.229.187","10.69.164.250","10.4.239.23","10.124.2.52","10.124.6.11","10.124.6.110","10.2.28.92","10.124.3.113","10.124.2.83","10.2.28.18","10.4.233.189","10.124.5.141","10.124.1.252","10.124.5.149","10.124.2.66","10.124.5.26","10.124.6.222","10.2.29.77","@h=","10.124.4.187","10.5.241.60","10.124.4.249","10.4.243.62","10.124.2.20","10.4.228.248","10.2.28.88","10.4.237.187","10.124.2.148","10.124.1.137","10.124.1.240","10.2.30.77","10.124.1.140","10.4.241.235","10.124.1.133","10.2.21.217","10.124.3.106","10.124.5.217","10.124.5.75","10.124.5.182","10.2.28.99","10.2.18.204","10.124.6.80","10.5.237.213","10.124.5.54","10.4.235.64","10.2.28.39","10.124.3.219","10.124.5.220","10.124.2.8","10.124.5.107","10.124.1.218","10.124.2.9","10.124.1.220","10.124.1.53","10.124.2.31","10.124.1.223","10.124.5.218","10.124.2.227","10.124.1.54","10.124.6.212","10.4.230.71","10.124.5.160","10.124.2.234","10.2.18.205","10.124.6.241","10.124.4.137","10.2.18.221","10.69.173.233","10.124.1.149","10.124.1.245","10.2.18.214","10.124.4.168","10.4.228.193","10.124.5.113","10.4.239.36","10.124.2.88","10.4.230.30","10.124.5.12","10.4.240.82","10.2.29.52","10.4.236.158","10.124.5.78","10.2.28.116","10.2.28.63","10.2.18.207","10.124.6.24","10.124.2.221","10.124.6.240","10.124.1.198","10.124.3.200","10.124.4.223","10.124.1.114","10.124.4.227","10.2.29.57","10.124.2.160","10.4.241.79","10.2.18.212","10.124.2.33","10.124.3.172","10.124.3.25","10.4.246.70","10.2.7.165","10.124.1.250","10.124.2.134","10.124.3.71","10.124.4.95","10.124.4.172","10.66.11.108","10.69.169.236","10.124.3.117","10.4.236.40","10.124.2.71","10.4.244.46","10.2.29.59","10.124.4.29","10.4.242.249","10.124.5.136","10.2.28.106","10.124.2.164","10.124.5.244","10.124.2.228","10.124.4.138","10.4.228.214","10.4.244.9","10.66.32.204","10.5.237.222","10.2.28.14","10.124.4.148","10.2.28.65","10.124.3.109","10.124.5.225","10.4.239.96","10.124.4.139","10.124.5.128","10.124.1.161","10.4.229.57","10.124.3.62","10.124.1.118","10.124.5.194","10.124.6.36","10.5.233.45","10.124.2.3","10.2.28.203","10.124.6.183","10.2.28.109","10.124.1.143","10.124.3.67","10.124.3.145","10.2.28.127","10.2.18.160","10.4.230.51","10.124.5.183","10.124.5.253","10.124.1.197","10.69.172.223","10.124.3.59","10.124.1.124","10.124.4.129","10.5.236.206","10.124.2.162","10.2.28.42","10.124.1.116","10.2.30.46","10.124.6.160","10.124.5.84","10.124.5.83","10.2.28.148","10.124.6.144","10.124.5.89","10.124.3.56","10.66.11.147","10.124.4.154","10.124.2.41","10.2.18.228","10.124.5.77","10.2.28.61","10.124.3.97","10.124.3.236","10.124.2.179","10.124.3.235","10.124.5.62","10.5.232.176","10.4.246.162","10.124.3.107","10.124.2.110","10.124.2.143","10.4.237.212","10.124.3.239","10.4.254.41","10.66.66.81","10.124.4.243","10.124.6.238","10.124.6.157","10.2.21.216","10.124.1.231","10.124.1.106","10.124.4.106","10.69.169.71","10.2.28.93","10.2.28.138","10.124.3.144","10.124.6.29","10.124.1.95","10.69.164.242","10.4.246.147","10.124.2.43","10.124.5.166","10.4.239.222","10.124.3.136","10.124.1.32","10.2.30.7","10.124.1.111","10.66.32.33","10.124.5.33","10.124.4.96","10.124.4.189","10.124.2.215","10.124.1.64","10.4.234.66","10.2.28.149","10.2.29.117","10.124.3.171","10.4.229.243","10.124.2.2","10.124.1.39","10.2.21.149","10.4.245.41","10.124.5.35","10.2.28.105","10.2.28.81","10.2.28.25","10.124.5.227","10.124.2.207","10.124.4.110","10.5.234.85","10.124.3.218","10.2.28.77","10.124.6.87","10.124.1.110","10.124.4.198","10.124.6.54","10.4.241.101","10.124.4.135","10.2.28.49","10.124.3.38","10.124.3.105","10.124.5.127","10.124.6.92","10.124.5.121","10.124.5.229","10.124.6.166","10.2.28.112","10.2.28.34","10.5.238.192","10.124.5.69","10.124.3.12","10.124.1.122","10.124.4.133","10.2.28.22","10.124.1.56","10.124.4.119","10.2.28.173","10.124.1.226","10.124.6.152","10.67.5.202","10.124.3.141","10.4.238.171","10.2.28.141","10.2.28.126","10.4.247.151","10.66.41.39","10.124.4.79","10.124.4.78","10.124.6.131","10.2.28.83","10.124.5.44","10.2.28.104","10.124.6.47","10.2.28.178","10.4.236.88","10.124.1.199","10.4.243.86","10.2.28.224","10.124.1.214","10.2.18.218","10.4.239.181","10.124.1.204","10.124.6.104","10.124.4.194","10.124.2.45","10.124.1.35","10.2.28.205","10.124.3.4","10.124.5.22","10.4.231.68","10.124.5.191","10.2.28.45","10.124.5.129","10.124.6.85","10.124.2.22","10.124.2.174","10.124.1.7","10.124.3.229","10.124.5.11","10.124.5.81","10.124.2.58","10.69.173.244","10.124.5.39","10.124.4.24","10.2.28.75","10.124.3.163","10.2.28.145","10.5.235.252","10.2.18.145","10.124.4.123","10.2.28.217","10.4.239.250","10.124.4.233","10.4.233.154","10.124.4.32","10.124.2.204","10.124.3.110","10.124.4.140","10.2.28.119","10.124.2.192","10.4.228.83","10.124.2.6","10.2.18.139","10.124.4.76","10.124.3.69","10.2.28.73","10.124.5.157","10.124.5.96","10.2.28.168","172.26.0.150","10.2.28.69","10.124.1.84","10.124.4.155","10.124.5.150","10.2.28.118","10.69.168.244","10.4.235.153","10.124.5.190","10.124.4.61","10.124.3.30","10.124.4.166","10.5.236.221","10.124.4.193","10.124.6.153","10.2.28.159","10.4.240.2","10.124.2.226","10.2.28.152","10.2.28.16","10.4.228.236","10.66.42.176","10.124.6.48","10.124.4.190","10.2.28.85","10.4.242.16","10.124.6.127","10.124.2.70","10.124.3.36","10.124.3.82","10.4.237.230","10.4.230.165","10.124.2.185","10.4.237.74","10.124.6.194","10.124.1.119","10.124.2.130","10.124.6.79","10.2.28.165","10.124.2.165","10.5.239.199","10.124.2.53","10.66.11.138","10.124.2.125","10.124.5.61","10.124.1.68","10.124.4.6","10.124.5.162","10.124.5.82","10.2.18.188","172.26.24.47","10.2.28.221","10.2.28.38","10.124.2.203","10.2.28.46","10.124.5.63","10.124.6.145","10.5.237.100","10.2.30.65","10.5.239.103","10.124.1.112","10.124.5.195","10.4.230.232","10.2.28.15","10.124.1.136","10.124.3.135","10.124.1.191","10.4.235.186","10.124.3.242","10.124.1.251","10.2.30.38","10.124.2.87","10.66.16.21","10.4.231.140","10.124.2.137","10.2.28.135","10.2.18.208","10.2.29.55","10.4.237.149","10.124.1.184","10.124.1.180","10.2.28.136","10.124.3.92","10.2.18.201","10.2.28.11","10.124.2.42","10.124.4.218","172.26.2.65","10.124.6.96","10.124.2.14","10.124.1.62","10.124.1.31","10.124.3.52","10.2.13.25","10.124.6.245","10.4.230.59","10.124.2.116","10.124.5.228","10.124.3.121","10.2.28.103","10.124.3.191","10.4.236.190","10.2.28.114","10.124.6.42","172.26.14.70","10.4.244.83","10.4.237.57","10.124.1.50","10.124.2.194","10.124.2.114","10.124.5.126","10.124.3.94","10.124.1.57","10.124.3.16","10.124.6.172","10.5.239.190","10.124.4.169","10.124.1.120","10.2.28.47","10.5.232.52","10.4.245.165","10.4.229.169","10.124.2.62","10.124.2.76","10.124.4.181","10.124.2.220","10.124.4.141","10.5.235.222","10.4.233.8","10.2.18.206","10.124.1.131","10.4.236.157","10.124.4.153","10.4.228.239","10.5.232.140","10.2.28.78","10.2.28.137","10.4.231.229","10.124.2.59","10.124.4.130","10.2.28.67","10.2.21.212","10.124.1.121","10.2.28.101","10.124.2.254","10.124.5.174","10.2.21.215","10.4.235.62","10.124.5.203","10.124.1.248","10.5.232.116","10.124.2.224","10.124.1.228","10.4.229.39","10.124.6.200","10.5.232.210","10.69.169.235","10.124.5.98","10.2.28.21","10.2.18.202","10.4.233.82","10.2.9.184",
      "10.124.6.12","10.124.3.215","10.2.28.62","10.124.3.17","10.124.1.205","10.124.1.61","10.2.28.94","10.4.237.140","10.4.242.214","10.2.28.142","10.124.3.68","10.124.1.75","10.124.6.74","10.124.2.122","10.2.28.177","10.2.28.167","10.2.9.166","10.124.5.109","10.66.15.27","10.67.5.249","10.124.6.5","10.69.173.177","10.124.2.150","10.4.234.190","10.4.244.136","10.2.30.31","10.124.6.221","10.2.30.61","10.67.5.212","10.4.245.133","10.4.228.228","10.124.1.138","10.124.5.74","10.124.6.55","10.2.28.29","10.4.232.130","10.4.244.84","10.4.246.253","10.4.231.17","10.124.3.27","10.4.233.142","10.124.6.168","10.4.229.82","10.4.232.158","10.5.237.163","10.124.3.160","10.124.2.57","10.2.28.24","10.4.234.194","10.2.28.154","10.2.18.217","10.4.232.78","10.124.1.134","10.5.234.201","10.124.5.223","10.124.4.81","10.4.228.90","10.124.2.64","10.124.1.205","10.5.239.161","10.5.239.119","10.5.234.195","172.27.5.212","127.0.0.3","10.4.243.80","10.4.239.216","10.4.238.159","10.5.238.246"
    )
    Env.values.foreach{
      curEnv=>
        ipList.foreach{
          curIP=>
            val thrift_http_desc =  Path.provider
            val providerPath = List("/mns/sankuai", curEnv, appkey, thrift_http_desc).mkString("/")
            val node =  curIP+ ":5266"
            val nodePath = List(providerPath, node).mkString("/")
            if(ZkClient.exist(nodePath)){
              ZkClient.deleteWithChildren(nodePath)
              println(s"delete sgagent provider: $nodePath")
              val currentTime = System.currentTimeMillis() / 1000

              val apppkeyTs = AppkeyTs(appkey, currentTime)
              val providerData = Json.prettyPrint(Json.toJson(apppkeyTs))
              ZkClient.setData(providerPath, providerData)
            }
        }
    }
  }
}
