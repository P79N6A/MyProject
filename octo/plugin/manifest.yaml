version: v1
build:
  os: centos6-cpp
  env:
    app_version: v1.1
  tools:
    boost:
    boost-devel:
    muduo:
    libevent-devel:
    libevent:
    log4cplus:
    e2fsprogs-devel:
    uuid-devel:
    libuuid-devel:
    openssl:
    openssl-devel:
  run:
    workDir: ./plugin
    cmd:
    - cmake ./
    - make
    - cp -rf script/run bin/
  target:
    distDir: plugin/bin/
    files:
    - cplugin
    - run
deploy:
  targetDir: /opt/meituan/apps/cplugin
  run:
    workDir: ./
    cmd:
    - ln -snf /opt/meituan/apps/cplugin /service/cplugin
    - sudo svc -d /service/sg_agent
    - sudo svc -d /service/sg_agent_worker
    - sudo svc -du /service/cplugin
